# 操作系统专业教程

## 前言

## 第一部分：操作系统基础

### 第一章：操作系统导论
    - 1.1 操作系统的定义与作用
    - 1.2 操作系统的发展历程
    - 1.3 操作系统的分类
        - 1.3.1 批处理操作系统
        - 1.3.2 分时操作系统
        - 1.3.3 实时操作系统
        - 1.3.4 分布式操作系统
        - 1.3.5 网络操作系统
        - 1.3.6 嵌入式操作系统
        - 1.3.7 移动操作系统
    - 1.4 操作系统的主要功能
        - 1.4.1 进程管理
        - 1.4.2 内存管理
        - 1.4.3 文件系统管理
        - 1.4.4 设备管理
        - 1.4.5 用户接口
    - 1.5 操作系统结构
        - 1.5.1 单体结构
        - 1.5.2 分层结构
        - 1.5.3 微内核结构
        - 1.5.4 外核结构
        - 1.5.5 虚拟机结构
    - 1.6 现代操作系统特性
    - 1.7 总结与展望

### 第二章：进程与线程
    - 2.1 进程的概念
        - 2.1.1 进程的定义与特征
        - 2.1.2 进程状态与转换
        - 2.1.3 进程控制块 (PCB)
    - 2.2 进程调度
        - 2.2.1 调度队列与调度器
        - 2.2.2 调度时机与切换
        - 2.2.3 调度目标
        - 2.2.4 调度算法
            - 2.2.4.1 先来先服务 (FCFS)
            - 2.2.4.2 最短作业优先 (SJF)
            - 2.2.4.3 优先级调度
            - 2.2.4.4 时间片轮转 (RR)
            - 2.2.4.5 多级队列调度
            - 2.2.4.6 多级反馈队列调度
        - 2.2.5 实时调度
        - 2.2.6 调度算法评估
    - 2.3 进程间通信 (IPC)
        - 2.3.1 共享内存
        - 2.3.2 消息传递
        - 2.3.3 管道
        - 2.3.4 信号量
        - 2.3.5 套接字
    - 2.4 线程的概念
        - 2.4.1 线程的引入与优势
        - 2.4.2 用户级线程与内核级线程
        - 2.4.3 多线程模型
            - 2.4.3.1 多对一模型
            - 2.4.3.2 一对一模型
            - 2.4.3.3 多对多模型
    - 2.5 线程管理
        - 2.5.1 线程的创建与销毁
        - 2.5.2 线程同步与互斥
    - 2.6 进程与线程的比较
    - 2.7 总结

### 第三章：并发与同步
    - 3.1 并发的基本概念
        - 3.1.1 并发与并行
        - 3.1.2 竞争条件与临界区
    - 3.2 同步与互斥
        - 3.2.1 互斥的概念与要求
        - 3.2.2 同步的概念与机制
    - 3.3 解决临界区问题的软件方案
        - 3.3.1 Peterson 算法
    - 3.4 解决临界区问题的硬件支持
        - 3.4.1 中断屏蔽
        - 3.4.2 原子指令 (Test-and-Set, Swap)
    - 3.5 信号量 (Semaphore)
        - 3.5.1 信号量的定义与操作
        - 3.5.2 使用信号量解决同步问题 (生产者-消费者问题)
        - 3.5.3 使用信号量解决互斥问题
        - 3.5.4 信号量的实现
    - 3.6 管程 (Monitor)
        - 3.6.1 管程的概念与结构
        - 3.6.2 条件变量
        - 3.6.3 使用管程解决同步问题
    - 3.7 死锁 (Deadlock)
        - 3.7.1 死锁的概念与产生的必要条件
        - 3.7.2 资源分配图
        - 3.7.3 死锁预防
        - 3.7.4 死锁避免 (银行家算法)
        - 3.7.5 死锁检测与恢复
    - 3.8 原子事务
    - 3.9 总结

### 第四章：内存管理
    - 4.1 内存管理基础
        - 4.1.1 地址空间与地址绑定
        - 4.1.2 逻辑地址与物理地址
        - 4.1.3 内存管理单元 (MMU)
        - 4.1.4 动态加载与动态链接
    - 4.2 连续内存分配
        - 4.2.1 固定分区分配
        - 4.2.2 可变分区分配
        - 4.2.3 内存碎片问题 (内部碎片与外部碎片)
        - 4.2.4 碎片整理
    - 4.3 分页 (Paging)
        - 4.3.1 基本分页原理
        - 4.3.2 页表结构
            - 4.3.2.1 层次页表
            - 4.3.2.2 哈希页表
            - 4.3.2.3 反向页表
        - 4.3.3 转换检测缓冲区 (TLB)
        - 4.3.4 内存保护
        - 4.3.5 分页的优缺点
    - 4.4 分段 (Segmentation)
        - 4.4.1 基本分段原理
        - 4.4.2 段表
        - 4.4.3 分段的优缺点
        - 4.4.4 分页与分段的结合 (段页式管理)
    - 4.5 虚拟内存 (Virtual Memory)
        - 4.5.1 虚拟内存的概念与优势
        - 4.5.2 请求调页 (Demand Paging)
        - 4.5.3 写时复制 (Copy-on-Write)
        - 4.5.4 页面置换算法
            - 4.5.4.1 FIFO 算法
            - 4.5.4.2 最优 (OPT) 算法
            - 4.5.4.3 最近最少使用 (LRU) 算法
            - 4.5.4.4 LRU 近似算法 (时钟算法, 二次机会算法)
            - 4.5.4.5 最不常用 (LFU) 算法
            - 4.5.4.6 MFU 算法
        - 4.5.5 帧分配策略
        - 4.5.6 抖动 (Thrashing)
    - 4.6 内核内存管理
    - 4.7 总结

### 第五章：文件系统
    - 5.1 文件概念
        - 5.1.1 文件属性
        - 5.1.2 文件操作
        - 5.1.3 文件类型
        - 5.1.4 文件结构
    - 5.2 访问方法
        - 5.2.1 顺序访问
        - 5.2.2 直接访问
        - 5.2.3 索引访问
    - 5.3 目录结构
        - 5.3.1 单层目录
        - 5.3.2 双层目录
        - 5.3.3 树形目录
        - 5.3.4 无环图目录
        - 5.3.5 通用图目录
    - 5.4 文件系统挂载
    - 5.5 文件共享与保护
        - 5.5.1 多用户环境下的文件共享
        - 5.5.2 访问控制列表 (ACL)
        - 5.5.3 Unix 权限模型
    - 5.6 文件系统实现
        - 5.6.1 文件系统结构 (分层模型)
        - 5.6.2 虚拟文件系统 (VFS)
        - 5.6.3 目录实现 (线性列表, 哈希表)
        - 5.6.4 文件分配方法
            - 5.6.4.1 连续分配
            - 5.6.4.2 链式分配 (FAT)
            - 5.6.4.3 索引分配 (inode)
        - 5.6.5 空闲空间管理
            - 5.6.5.1 位图法
            - 5.6.5.2 空闲链表法
            - 5.6.5.3 成组链接法
    - 5.7 效率与性能
        - 5.7.1 磁盘缓存 (Buffer Cache)
        - 5.7.2 磁盘调度
    - 5.8 恢复与一致性
        - 5.8.1 日志文件系统 (Journaling File System)
        - 5.8.2 写时复制文件系统 (Copy-on-Write File System)
    - 5.9 案例研究：FAT, NTFS, ext4, ZFS
    - 5.10 总结

### 第六章：输入/输出管理
    - 6.1 I/O 硬件基础
        - 6.1.1 I/O 设备分类
        - 6.1.2 总线结构
        - 6.1.3 控制器与端口
        - 6.1.4 直接内存访问 (DMA)
    - 6.2 I/O 软件层次结构
        - 6.2.1 中断处理程序
        - 6.2.2 设备驱动程序
        - 6.2.3 独立于设备的 I/O 软件
        - 6.2.4 用户空间的 I/O 软件 (库函数, Spooling)
    - 6.3 I/O 请求处理
        - 6.3.1 阻塞 I/O 与非阻塞 I/O
        - 6.3.2 同步 I/O 与异步 I/O
    - 6.4 内核 I/O 子系统
        - 6.4.1 I/O 调度
        - 6.4.2 缓冲 (Buffering)
        - 6.4.3 高速缓存 (Caching)
        - 6.4.4 Spooling 与设备预留
        - 6.4.5 错误处理
        - 6.4.6 I/O 保护
    - 6.5 磁盘结构与调度
        - 6.5.1 磁盘物理结构
        - 6.5.2 磁盘调度算法
            - 6.5.2.1 FCFS 调度
            - 6.5.2.2 SSTF 调度
            - 6.5.2.3 SCAN (电梯) 调度
            - 6.5.2.4 C-SCAN 调度
            - 6.5.2.5 LOOK 与 C-LOOK 调度
        - 6.5.3 磁盘格式化与引导块
        - 6.5.4 坏块管理
    - 6.6 RAID 结构
        - 6.6.1 RAID 级别 (RAID 0, 1, 5, 6, 10)
        - 6.6.2 RAID 的优缺点
    - 6.7 总结

## 第二部分：操作系统进阶

### 第七章：虚拟化技术
    - 7.1 虚拟化概述
        - 7.1.1 虚拟化的概念与优势
        - 7.1.2 虚拟化技术分类
    - 7.2 CPU 虚拟化
        - 7.2.1 特权级与陷入模拟
        - 7.2.2 二进制翻译
        - 7.2.3 硬件辅助虚拟化 (Intel VT-x, AMD-V)
    - 7.3 内存虚拟化
        - 7.3.1 影子页表 (Shadow Page Tables)
        - 7.3.2 扩展页表 (EPT) / 嵌套页表 (NPT)
    - 7.4 I/O 虚拟化
        - 7.4.1 全虚拟化 I/O
        - 7.4.2 半虚拟化 I/O (VirtIO)
        - 7.4.3 I/O 直通 (Passthrough, SR-IOV)
    - 7.5 虚拟机监视器 (VMM) / Hypervisor
        - 7.5.1 Type-1 Hypervisor (裸金属)
        - 7.5.2 Type-2 Hypervisor (宿主型)
    - 7.6 容器化技术 (如 Docker)
        - 7.6.1 容器与虚拟机的区别
        - 7.6.2 命名空间 (Namespaces)
        - 7.6.3 控制组 (Cgroups)
        - 7.6.4 联合文件系统 (UnionFS)
    - 7.7 云计算与虚拟化
    - 7.8 案例研究：VMware, KVM, Xen, Docker
    - 7.9 总结

### 第八章：分布式系统
    - 8.1 分布式系统概述
        - 8.1.1 分布式系统的定义与特征
        - 8.1.2 分布式系统的目标与挑战
        - 8.1.3 分布式系统模型
    - 8.2 通信
        - 8.2.1 RPC (远程过程调用)
        - 8.2.2 RMI (远程方法调用)
        - 8.2.3 消息队列
    - 8.3 同步与协调
        - 8.3.1 时钟同步 (物理时钟, 逻辑时钟: Lamport, Vector)
        - 8.3.2 互斥算法 (集中式, 分布式, 令牌环)
        - 8.3.3 选举算法 (Bully, Ring)
        - 8.3.4 分布式事务与两阶段提交 (2PC)
        - 8.3.5 共识算法 (Paxos, Raft)
    - 8.4 分布式文件系统 (DFS)
        - 8.4.1 DFS 的设计目标
        - 8.4.2 命名与透明性
        - 8.4.3 远程文件访问
        - 8.4.4 缓存机制
        - 8.4.5 一致性与副本管理
        - 8.4.6 案例研究：NFS, AFS, GFS, HDFS
    - 8.5 分布式共享内存 (DSM)
    - 8.6 分布式调度与负载均衡
    - 8.7 容错与恢复
    - 8.8 总结

### 第九章：操作系统安全
    - 9.1 安全威胁与目标
        - 9.1.1 威胁类型 (病毒, 蠕虫, 木马, Rootkit, 勒索软件)
        - 9.1.2 安全目标 (机密性, 完整性, 可用性)
    - 9.2 认证 (Authentication)
        - 9.2.1 密码
        - 9.2.2 生物识别
        - 9.2.3 多因素认证
    - 9.3 访问控制 (Access Control)
        - 9.3.1 访问控制矩阵
        - 9.3.2 访问控制列表 (ACL)
        - 9.3.3 能力表 (Capability Lists)
        - 9.3.4 基于角色的访问控制 (RBAC)
    - 9.4 恶意软件防护
        - 9.4.1 防病毒软件
        - 9.4.2 防火墙
        - 9.4.3 入侵检测系统 (IDS) / 入侵防御系统 (IPS)
    - 9.5 内存保护机制
        - 9.5.1 地址空间布局随机化 (ASLR)
        - 9.5.2 数据执行保护 (DEP) / NX 位
        - 9.5.3 Stack Canaries
    - 9.6 加密技术
        - 9.6.1 对称加密与非对称加密
        - 9.6.2 数字签名与证书
        - 9.6.3 全盘加密
    - 9.7 系统加固与审计
    - 9.8 Windows 与 Linux 安全特性对比
    - 9.9 总结

### 第十章：嵌入式与实时操作系统
    - 10.1 嵌入式系统概述
        - 10.1.1 嵌入式系统的特点与应用
        - 10.1.2 嵌入式操作系统的要求
    - 10.2 实时系统 (RTOS)
        - 10.2.1 实时系统的定义与分类 (硬实时, 软实时)
        - 10.2.2 RTOS 的特征 (可预测性, 实时调度)
        - 10.2.3 实时调度算法 (RM, EDF)
        - 10.2.4 优先级反转问题与解决方案 (优先级继承, 优先级天花板)
    - 10.3 常见的嵌入式操作系统
        - 10.3.1 FreeRTOS
        - 10.3.2 VxWorks
        - 10.3.3 QNX
        - 10.3.4 嵌入式 Linux
        - 10.3.5 Android (作为嵌入式 OS)
    - 10.4 嵌入式系统的内存管理
    - 10.5 嵌入式系统的功耗管理
    - 10.6 嵌入式系统的 I/O
    - 10.7 物联网 (IoT) 与嵌入式操作系统
    - 10.8 总结

## 第三部分：案例研究与未来展望

### 第十一章：Linux 操作系统剖析
    - 11.1 Linux 发展历史与哲学
    - 11.2 Linux 内核架构
        - 11.2.1 内核模块
        - 11.2.2 系统调用接口
    - 11.3 进程管理
        - 11.3.1 `fork()`, `exec()`, `wait()`
        - 11.3.2 CFS 调度器
        - 11.3.3 命名空间与 Cgroups
    - 11.4 内存管理
        - 11.4.1 Buddy System 与 Slab Allocator
        - 11.4.2 页表管理
        - 11.4.3 OOM Killer
    - 11.5 文件系统
        - 11.5.1 VFS 接口
        - 11.5.2 ext4 文件系统详解
        - 11.5.3 Btrfs 与 ZFS (on Linux) 简介
    - 11.6 I/O 系统
        - 11.6.1 块设备层与字符设备层
        - 11.6.2 I/O 调度器 (noop, deadline, cfq, bfq)
    - 11.7 网络栈
    - 11.8 安全机制 (SELinux, AppArmor)
    - 11.9 总结

### 第十二章：Windows 操作系统剖析
    - 12.1 Windows 发展历史与版本
    - 12.2 Windows 系统架构
        - 12.2.1 HAL (硬件抽象层)
        - 12.2.2 内核 (Kernel)
        - 12.2.3 执行体 (Executive)
        - 12.2.4 子系统 (Win32, POSIX, OS/2)
    - 12.3 进程与线程管理
        - 12.3.1 进程、作业、线程、纤程
        - 12.3.2 调度算法 (优先级队列)
        - 12.3.3 UMS (用户模式调度)
    - 12.4 内存管理
        - 12.4.1 虚拟地址空间布局
        - 12.4.2 页表管理与 VAD 树
        - 12.4.3 Working Set 与内存压缩
    - 12.5 文件系统
        - 12.5.1 NTFS 文件系统详解 (MFT, 流, 日志)
        - 12.5.2 ReFS 简介
        - 12.5.3 I/O 管理器
    - 12.6 网络
        - 12.6.1 Winsock API
        - 12.6.2 网络驱动程序接口规范 (NDIS)
    - 12.7 安全模型 (对象管理器, 安全引用监视器, ACL)
    - 12.8 注册表 (Registry)
    - 12.9 总结

### 第十三章：macOS 操作系统剖析
    - 13.1 macOS 发展历史 (NeXTSTEP, OS X)
    - 13.2 macOS 架构 (Aqua, Core Services, Core OS/Darwin)
    - 13.3 XNU 内核
        - 13.3.1 Mach 微内核 (IPC, 任务, 线程, 虚拟内存)
        - 13.3.2 BSD 层 (进程模型, POSIX API, 网络栈, VFS)
        - 13.3.3 I/O Kit (驱动模型)
    - 13.4 进程与线程管理
    - 13.5 内存管理
    - 13.6 文件系统
        - 13.6.1 HFS+ 文件系统
        - 13.6.2 APFS 文件系统详解 (写时复制, 快照, 加密)
    - 13.7 安全特性 (Gatekeeper, SIP, TCC, Keychain)
    - 13.8 Grand Central Dispatch (GCD) 与并发
    - 13.9 Launchd 初始化系统
    - 13.10 总结

### 第十四章：移动操作系统 (Android & iOS) 简介
    - 14.1 移动操作系统的特点与挑战
        - 14.1.1 资源受限 (电池, CPU, 内存)
        - 14.1.2 用户体验与交互
        - 14.1.3 安全与隐私
        - 14.1.4 应用生态
    - 14.2 Android 操作系统
        - 14.2.1 Android 架构 (Linux 内核, HAL, Runtime, Framework, Applications)
        - 14.2.2 ART (Android Runtime) 与 Dalvik VM
        - 14.2.3 Activity Manager 与应用生命周期
        - 14.2.4 Binder IPC 机制
        - 14.2.5 电源管理
        - 14.2.6 安全模型 (权限, 沙箱, SELinux)
    - 14.3 iOS 操作系统
        - 14.3.1 iOS 架构 (Core OS, Core Services, Media, Cocoa Touch)
        - 14.3.2 XNU 内核基础
        - 14.3.3 应用生命周期与沙箱
        - 14.3.4 IPC 机制 (XPC)
        - 14.3.5 安全特性 (Code Signing, Secure Enclave)
    - 14.4 Android 与 iOS 的比较
    - 14.5 总结

### 第十五章：操作系统的未来趋势
    - 15.1 云原生操作系统
    - 15.2 微内核的复兴与 unikernels
    - 15.3 面向异构计算的操作系统 (CPU, GPU, TPU, FPGA)
    - 15.4 持久内存 (Persistent Memory) 对操作系统的影响
    - 15.5 物联网与边缘计算操作系统
    - 15.6 AI/ML 在操作系统中的应用 (调度, 内存管理, 安全)
    - 15.7 安全与隐私的持续挑战
    - 15.8 可验证与形式化方法的应用
    - 15.9 开源操作系统的发展
    - 15.10 总结与展望

## 附录

### 附录 A：常用系统调用接口 (POSIX, Win32)
### 附录 B：术语表
### 附录 C：参考文献 